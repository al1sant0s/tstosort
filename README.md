# Generate storemenu files sorted by alphabetical order

This tool allows you to create storemenu files sorted in alphabetical order according to each language available in
the game 'The Simpsons: Tapped Out'.

## Installation

First, make sure you have [**python**](https://www.python.org/downloads/)
and [**git**](https://git-scm.com/downloads) installed on your system.

With those requirements satisfied, run either of the following commands in the command-line interface to install tstosort, according to your OS:

* Windows installation command.

```shell
python -m pip install tstosort@git+https://github.com/al1sant0s/tstosort
```

* Linux installation command.

```shell
python3 -m pip install tstosort@git+https://github.com/al1sant0s/tstosort
```

If you use windows I recommend you to get the modern [windows terminal from microsoft store](https://apps.microsoft.com/detail/9n0dx20hk701?hl).

## Basic usage

To get the full help execute the following command:

```shell
tstosort --help
```

## Generate storemenus for all languages

Use the --directories [-d] argument and list the dlcs which you want to create storemenus to.

```shell
tstosort -d /path/to/dlc/
```

The tool will receive a list of directories, each representing one dlc which has the gamescripts and textpools subfolders.
The textpools folders need to named in the format "textpools-\*. The files generated will have the prefix "autogenerated_\*".
Here \* stands for one of language codes used by the game.

## Adding new files to the store

You should not edit the autogenerated files. You will only edit the file "mainstoremenu.xml" and all "storemenu*.xml" files. Here
\* stands for any string between the "storemenu" and ".xml" like "storemenu_buildings.xml" or "storemenu_perm_settings.xml".

To actually see the items in alphabetical order in the store, you'll also need to implement some logic to set the variable
"AUTOGENERATED_SORT_STOREMENU_ENABLE" to 1 and reparse the store files in game to update them.
If you wish, you can also implement a logic to toggle the value using the logic

```
<Action type="setVariable" intVariable="AUTOGENERATED_SORT_STOREMENU_ENABLE" intValue="1 - AUTOGENERATED_SORT_STOREMENU_ENABLE" />
<Action type="returnToInGameState" />
<Action type="reparseBuildMenu" />
<Action type="focusOnMenuItem" menuCategory="FrontPage" />
```

## Generate storemenus for specific languages

During development of your dlc, you might want to work with the alphabetical order while you check if the new items have been
added to the storemenus. In that case you you can use the --language [-l] option to generate the files only for the languages you are working on.
For example, this will generate the storemenu files only for english and portuguese:

```
tstosort -l en pt -d /path/to/dlc/
```

Keep in mind that each time the command is ran, all previously autogenerated files get deleted. This means that if you change the language in game to one which
you have not autogenerated new specific storemenu files and the variable `AUTOGENERATED_SORT_STOREMENU_ENABLE` is set to 1, attempting to open the store
will result in the game crashing. That's why when you are done with your dlc, you should run the command once more to generate the files for all languages.


## XML indentation level

Choose the indentation level to be used to produce the xml files. The default value is 2, if you
wish to use an indentation level of 4 for example:

```shell
tstosort -i 4 /path/to/dlc/
```
